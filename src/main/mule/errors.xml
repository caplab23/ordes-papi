<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core"
	xmlns:dw="http://www.mulesoft.org/schema/mule/ee/dw" xmlns="http://www.mulesoft.org/schema/mule/core"
	xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="
http://www.mulesoft.org/schema/mule/ee/dw http://www.mulesoft.org/schema/mule/ee/dw/current/dw.xsd http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd">


	<error-handler name="globalError_Handler" doc:id="19929c11-7a77-40c3-aa82-0670718043a9">

		<!-- APIKit router related exceptions -->
		<on-error-continue type="APIKIT:BAD_REQUEST" enableNotifications="true" logException="true" doc:name="On Error Continue" doc:id="92adaee1-5ebe-40de-a006-87f64db25da6" >
			<set-variable value="#[400]" doc:name="Set the HTTP Status - 400" doc:id="7f01f68b-c109-43be-9a7c-f995f3e93251" variableName="httpStatus"/>
      <set-variable value="BAD_REQUEST" doc:name="Set Error Code" doc:id="66c57459-789c-4a3a-be50-02b45d439271" variableName="errorCode"/>
			<set-variable value='#[if (error.muleMessage.payload != null) error.muleMessage.payload else error.description default ""]' doc:name="Set Error Message" doc:id="392cd215-389a-43c5-9aff-27ea91d5ec3c" variableName="errorMessage" />
			<flow-ref doc:name="global-prepare-error-response-sub-flow" doc:id="dc46f2bc-00b0-435c-bd3b-ae5d56f96c63" name="global-prepare-error-response-sub-flow"/>
		</on-error-continue>
		<on-error-continue type="APIKIT:METHOD_NOT_ALLOWED" enableNotifications="true" logException="true" doc:name="On Error Continue" doc:id="7ab9fb9b-bcfc-473a-911e-0731aa519a8b" >
			<set-variable value="#[405]" doc:name="Set the HTTP Status - 405" doc:id="74a9db01-50a4-4876-a478-0e063311fab1" variableName="httpStatus" />
      <set-variable value="METHOD_NOT_ALLOWED" doc:name="Set Error Code" doc:id="6c185da5-1cc0-439b-9d07-aa3017ffa9bd" variableName="errorCode"/>
			<set-variable value='#[if (error.muleMessage.payload != null) error.muleMessage.payload else error.description default ""]' doc:name="Set Error Message" doc:id="c272ff35-f1a8-43a9-9a8e-a4537bc9f805" variableName="errorMessage"/>
			<flow-ref doc:name="global-prepare-error-response-sub-flow" doc:id="0604ee3f-09ff-4bd0-9830-aa50ff911c6c" name="global-prepare-error-response-sub-flow"/>
		</on-error-continue>
		<on-error-continue type="APIKIT:NOT_ACCEPTABLE" enableNotifications="true" logException="true" doc:name="On Error Continue" doc:id="be432659-85ee-49e1-9030-3b8da8385077" >
			<set-variable value="#[406]" doc:name="Set the HTTP Status - 406" doc:id="61606f93-464d-45f6-b759-55cc39c905b6" variableName="httpStatus" />
      <set-variable value="NOT_ACCEPTABLE" doc:name="Set Error Code" doc:id="82c9b125-2710-44e0-b318-da13320a39b0" variableName="errorCode" />
			<set-variable value='#[if (error.muleMessage.payload != null) error.muleMessage.payload else error.description default ""]' doc:name="Set Error Message" doc:id="86761373-3504-4ac0-8c68-017d126bacf9" variableName="errorMessage" />
			<flow-ref doc:name="global-prepare-error-response-sub-flow" doc:id="7ff50f70-b45d-46e6-8791-df381e04cc26" name="global-prepare-error-response-sub-flow"/>
		</on-error-continue>
		<on-error-continue type="APIKIT:NOT_FOUND" enableNotifications="true" logException="true" doc:name="On Error Continue" doc:id="4ae23481-f052-4541-b576-9ff1a4bcdba6" >
			<set-variable value="#[404]" doc:name="Set the HTTP Status - 404" doc:id="24e0bfa4-6ba6-4b8d-b990-6594d9c98367" variableName="httpStatus" />
      <set-variable value="NOT_FOUND" doc:name="Set Error Code" doc:id="38f0224b-b6ad-4e72-92ff-3872568a5b0a" variableName="errorCode" />
			<set-variable value='#[if (error.muleMessage.payload != null) error.muleMessage.payload else error.description default ""]' doc:name="Set Error Message" doc:id="872da4fe-cf97-4a8a-9f10-415421e888eb" variableName="errorMessage" />
			<flow-ref doc:name="global-prepare-error-response-sub-flow" doc:id="5aa97afe-41a6-4d03-9ac9-125ab42a852c" name="global-prepare-error-response-sub-flow"/>
		</on-error-continue>
		<on-error-continue type="APIKIT:UNSUPPORTED_MEDIA_TYPE" enableNotifications="true" logException="true" doc:name="On Error Continue" doc:id="87c6629a-9898-4574-9bf0-343209c315df" >
			<set-variable value="#[415]" doc:name="Set the HTTP Status - 415" doc:id="571b73cf-90e2-4460-92d9-5ee7fcb9f7ba" variableName="httpStatus" />
      <set-variable value="UNSUPPORTED_MEDIA_TYPE" doc:name="Set Error Code" doc:id="a34c6c95-ac69-4703-a921-48d46247c1d4" variableName="errorCode" />
			<set-variable value='#[if (error.muleMessage.payload != null) error.muleMessage.payload else error.description default ""]' doc:name="Set Error Message" doc:id="9c8e0c75-d145-48e6-910c-ef90f8107def" variableName="errorMessage" />
			<flow-ref doc:name="global-prepare-error-response-sub-flow" doc:id="4e22910f-46dd-41a1-9c37-3d2a288546e6" name="global-prepare-error-response-sub-flow"/>
		</on-error-continue>	
		
		<!-- HTTP Requster Related error handling -->
		<on-error-continue enableNotifications="true" logException="true" doc:name="On Error Continue" doc:id="03ed44b0-e51c-4c51-b014-db91d8f603eb" type="HTTP:BAD_REQUEST">
			<set-variable value="#[400]" doc:name="Set the HTTP Status - 400" doc:id="3a7bacb0-1979-408f-b6eb-48230cfb334e" variableName="httpStatus" />
			<set-variable value="BAD_REQUEST" doc:name="Set Error Code" doc:id="8a65eb44-f716-4a78-90d5-fd8f5afd02a7" variableName="errorCode" />
			<set-variable value='#[if (error.muleMessage.payload != null) error.muleMessage.payload else error.description default ""]' doc:name="Set Error Message" doc:id="9b1d45a8-62bd-43f3-9e84-9152630924b8" variableName="errorMessage" />
			<flow-ref doc:name="global-prepare-error-response-sub-flow" doc:id="c0c3e3a1-81a3-447d-9336-2306353e672d" name="global-prepare-error-response-sub-flow" />
		</on-error-continue>
		<on-error-continue type="HTTP:CLIENT_SECURITY" enableNotifications="true" logException="true" doc:name="On Error Continue" doc:id="4a31f1e4-e34c-4cd1-9916-f184b6009271" >
			<set-variable value="#[401]" doc:name="Set the HTTP Status - 401" doc:id="fb30da24-8cd6-425a-89a1-88a396c096ea" variableName="httpStatus" />
      <set-variable value="UNAUTHORIZED" doc:name="Set Error Code" doc:id="c9c991a2-d122-4b1d-85bf-3162bf8ede4f" variableName="errorCode" />
			<set-variable value='#[if (error.muleMessage.payload != null) error.muleMessage.payload else error.description default ""]' doc:name="Set Error Message" doc:id="989d8236-a982-4d45-8787-bdab6e4d460a" variableName="errorMessage" />
			<flow-ref doc:name="global-prepare-error-response-sub-flow" doc:id="4fbdfc6d-56c2-475d-be1e-ea205315ff45" name="global-prepare-error-response-sub-flow"/>
		</on-error-continue>
		<on-error-continue type="HTTP:CONNECTIVITY" enableNotifications="true" logException="true" doc:name="On Error Continue" doc:id="c2249532-34cf-44ed-bd96-b1137edcd60c" >
			<set-variable value="#[503]" doc:name="Set the HTTP Status - 503" doc:id="d4ee1420-a843-4125-a8f8-672b2b06d920" variableName="httpStatus" />
      <set-variable value="SERVICE_UNAVAILABLE" doc:name="Set Error Code" doc:id="d5f7a00d-f7d1-4f8d-b829-0fa3dbb452ac" variableName="errorCode" />
			<set-variable value='#[if (error.muleMessage.payload != null) error.muleMessage.payload else error.description default ""]' doc:name="Set Error Message" doc:id="2959c9a7-38b4-4214-8d5a-9adcf87bf864" variableName="errorMessage" />
			<flow-ref doc:name="global-prepare-error-response-sub-flow" doc:id="a448aac1-6f16-4967-a1cf-a85b87bdcdb4" name="global-prepare-error-response-sub-flow"/>
		</on-error-continue>
		<on-error-continue type="HTTP:FORBIDDEN" enableNotifications="true" logException="true" doc:name="On Error Continue" doc:id="ea0f88b5-793d-42db-9618-3f98e9e208ab" >
			<set-variable value="#[403]" doc:name="Set the HTTP Status - 403" doc:id="1d771276-8784-48ab-9d88-dff97eca0be5" variableName="httpStatus" />
      <set-variable doc:name="Set Error Code" doc:id="0eed30ba-c15a-4f11-8cc1-a6b9c575b026" variableName="errorCode" value="FORBIDDEN"/>
			<set-variable value='#[if (error.muleMessage.payload != null) error.muleMessage.payload else error.description default ""]' doc:name="Set Error Message" doc:id="78b6943e-9057-42d1-8b27-ab878a46f034" variableName="errorMessage" />
			<flow-ref doc:name="global-prepare-error-response-sub-flow" doc:id="df4967e4-591b-4111-aed9-d30ee5259803" name="global-prepare-error-response-sub-flow"/>
		</on-error-continue>
		<on-error-continue type="HTTP:INTERNAL_SERVER_ERROR" enableNotifications="true" logException="true" doc:name="On Error Continue" doc:id="d943d1cb-ba30-47e2-b197-79a4f99913ec" >
			<set-variable value="#[500]" doc:name="Set the HTTP Status - 500" doc:id="46a21ed7-a6c5-4632-a7d7-2a39580a42eb" variableName="httpStatus" />
      <set-variable value="INTERNAL_SERVER_ERROR" doc:name="Set Error Code" doc:id="6c9b30d9-6ce8-4677-adbc-ade0d4eea05c" variableName="errorCode" />
			<set-variable value='#[if (error.muleMessage.payload != null) error.muleMessage.payload else error.description default ""]' doc:name="Set Error Message" doc:id="c5cc8b70-bdbc-473f-abeb-03ba6daea668" variableName="errorMessage" />
			<flow-ref doc:name="global-prepare-error-response-sub-flow" doc:id="fb1dc24e-cf52-49c4-9f1e-f7f7898cc0d7" name="global-prepare-error-response-sub-flow"/>
		</on-error-continue>
		<on-error-continue type="HTTP:METHOD_NOT_ALLOWED" enableNotifications="true" logException="true" doc:name="On Error Continue" doc:id="9a9adad8-8efa-4c52-84df-ba0e5644819f" >
			<set-variable value="#[405]" doc:name="Set the HTTP Status - 405" doc:id="aef0dde9-cd2a-479e-859a-af377426665f" variableName="httpStatus" />
      <set-variable value="METHOD_NOT_ALLOWED" doc:name="Set Error Code" doc:id="733f4b76-7831-49b3-8184-853e873169f4" variableName="errorCode" />
			<set-variable value='#[if (error.muleMessage.payload != null) error.muleMessage.payload else error.description default ""]' doc:name="Set Error Message" doc:id="f3a7cc62-f9e7-49f2-874d-31630f602b11" variableName="errorMessage" />
			<flow-ref doc:name="global-prepare-error-response-sub-flow" doc:id="1c0930cc-ff7e-4f6f-a0f8-e112f5b40bc4" name="global-prepare-error-response-sub-flow"/>
		</on-error-continue>
		<on-error-continue type="HTTP:NOT_ACCEPTABLE" enableNotifications="true" logException="true" doc:name="On Error Continue" doc:id="f124874c-7c5e-4326-89f4-29c96d8ba5aa" >
			<set-variable value="#[406]" doc:name="Set the HTTP Status - 406" doc:id="2f67cdde-84f1-4696-9e43-e474f4a8ea54" variableName="httpStatus" />
      <set-variable value="NOT_ACCEPTABLE" doc:name="Set Error Code" doc:id="21a42623-7acf-403b-957e-dd7b12a8ed4b" variableName="errorCode" />
			<set-variable value='#[if (error.muleMessage.payload != null) error.muleMessage.payload else error.description default ""]' doc:name="Set Error Message" doc:id="e615652c-7595-4a66-b7af-3915c44a4780" variableName="errorMessage" />
			<flow-ref doc:name="global-prepare-error-response-sub-flow" doc:id="ddde4713-012f-41ff-86b0-222316bb017d" name="global-prepare-error-response-sub-flow"/>
		</on-error-continue>
		<on-error-continue type="HTTP:NOT_FOUND" enableNotifications="true" logException="true" doc:name="On Error Continue" doc:id="d4a96f56-5c47-4d74-aaf8-8c1493439da1" >
			<set-variable value="#[404]" doc:name="Set the HTTP Status - 404" doc:id="d18024f8-6bc7-4a2a-afc8-e085ed522ee9" variableName="httpStatus" />
      <set-variable value="NOT_FOUND" doc:name="Set Error Code" doc:id="f78d0a88-b509-47ed-9755-87e07991fe99" variableName="errorCode" />
			<set-variable value='#[if (error.muleMessage.payload != null) error.muleMessage.payload else error.description default ""]' doc:name="Set Error Message" doc:id="3a18ed41-7739-41f3-b357-c6db63f5eae8" variableName="errorMessage" />
			<flow-ref doc:name="global-prepare-error-response-sub-flow" doc:id="482ec624-e312-469c-82fb-830545c34477" name="global-prepare-error-response-sub-flow"/>
		</on-error-continue>
		<on-error-continue type="HTTP:PARSING" enableNotifications="true" logException="true" doc:name="On Error Continue" doc:id="ebe67207-dea9-4a48-bcdc-716438a3a0ae" >
			<set-variable value="#[400]" doc:name="Set the HTTP Status - 400" doc:id="fff36cba-074f-4d7a-982a-e0b22055d790" variableName="httpStatus" />
      <set-variable value="BAD_REQUEST" doc:name="Set Error Code" doc:id="bbdfbe97-3b65-4cf0-a572-87776315a2a5" variableName="errorCode" />
			<set-variable value='#[if (error.muleMessage.payload != null) error.muleMessage.payload else error.description default ""]' doc:name="Set Error Message" doc:id="a91eb090-9c85-4c0b-99ee-bce03e75648d" variableName="errorMessage" />
			<flow-ref doc:name="global-prepare-error-response-sub-flow" doc:id="7551cf38-07fd-4626-8a75-708c1ec73731" name="global-prepare-error-response-sub-flow"/>
		</on-error-continue>
		<on-error-continue type="HTTP:RETRY_EXHAUSTED" enableNotifications="true" logException="true" doc:name="On Error Continue" doc:id="243435d2-ed33-4be7-a7a2-22ff146d29c5" >
			<set-variable value="#[503]" doc:name="Set the HTTP Status - 503" doc:id="f670d7fb-159c-4c7f-8045-053b1bfdf0cd" variableName="httpStatus" />
      <set-variable value="SERVICE_UNAVAILABLE" doc:name="Set Error Code" doc:id="3daa9dd5-5d47-4dea-ab67-9312385e0a27" variableName="errorCode" />
			<set-variable value='#[if (error.muleMessage.payload != null) error.muleMessage.payload else error.description default ""]' doc:name="Set Error Message" doc:id="d4aac592-9723-4ca4-9439-084134820fec" variableName="errorMessage" />
			<flow-ref doc:name="global-prepare-error-response-sub-flow" doc:id="b45bbb28-a10c-458a-af49-8dc4b7da35eb" name="global-prepare-error-response-sub-flow"/>
		</on-error-continue>
		<on-error-continue type="HTTP:SECURITY" enableNotifications="true" logException="true" doc:name="On Error Continue" doc:id="2f72c99a-ea6c-42ec-8f03-8a81833d9f90" >
			<set-variable value="#[401]" doc:name="Set the HTTP Status - 401" doc:id="302a175c-e5fa-4005-993f-9f10ddaa1027" variableName="httpStatus" />
      			<set-variable value="UNAUTHORIZED" doc:name="Set Error Code" doc:id="a465bcf0-5c7a-49bd-8a00-a64ebc2aea5a" variableName="errorCode" />
			<set-variable value='#[if (error.muleMessage.payload != null) error.muleMessage.payload else error.description default ""]' doc:name="Set Error Message" doc:id="a8beca6f-0651-42f2-8ad8-fd8ef77e3018" variableName="errorMessage" />
			<flow-ref doc:name="global-prepare-error-response-sub-flow" doc:id="dad5e8b7-7726-4290-8e21-8ee538aba0e1" name="global-prepare-error-response-sub-flow"/>
		</on-error-continue>
		<on-error-continue type="HTTP:TIMEOUT" enableNotifications="true" logException="true" doc:name="On Error Continue" doc:id="31baeed3-7831-4fb3-a15f-1e9bc61c5cfd" >
			<set-variable value="#[504]" doc:name="Set the HTTP Status - 504" doc:id="e26e0260-113e-450e-bc03-060763fb8ab1" variableName="httpStatus" />
      			<set-variable value="GATEWAY_TIMEOUT" doc:name="Set Error Code" doc:id="77e371f4-0cc2-47a5-998b-425efe170a41" variableName="errorCode" />
			<set-variable value='#[if (error.muleMessage.payload != null) error.muleMessage.payload else error.description default ""]' doc:name="Set Error Message" doc:id="03e0930c-4ea3-4211-8b14-63b9754e1e27" variableName="errorMessage" />
			<flow-ref doc:name="global-prepare-error-response-sub-flow" doc:id="6f35d402-10a1-4a6a-9837-67ddb004fed8" name="global-prepare-error-response-sub-flow"/>
		</on-error-continue>
		<on-error-continue type="HTTP:TOO_MANY_REQUESTS" enableNotifications="true" logException="true" doc:name="On Error Continue" doc:id="c2939e58-5589-4088-a1de-bf4113523724" >
			<set-variable value="#[429]" doc:name="Set the HTTP Status - 429" doc:id="79e3b501-212d-40b5-8eae-3f89974fee25" variableName="httpStatus" />
      			<set-variable value="TOO_MANY_REQUESTS" doc:name="Set Error Code" doc:id="2d32f6ea-de0f-40e5-a455-5345929d50cc" variableName="errorCode" />
			<set-variable value='#[if (error.muleMessage.payload != null) error.muleMessage.payload else error.description default ""]' doc:name="Set Error Message" doc:id="7eb91df4-1fa0-476b-9076-54d5ae214588" variableName="errorMessage" />
			<flow-ref doc:name="global-prepare-error-response-sub-flow" doc:id="41e7445f-0de8-4ffc-bd00-fd7504063c79" name="global-prepare-error-response-sub-flow"/>
		</on-error-continue>
		<on-error-continue type="HTTP:UNAUTHORIZED" enableNotifications="true" logException="true" doc:name="On Error Continue" doc:id="2abd58c4-5303-489f-a89b-37690b1ec108" >
			<set-variable value="#[401]" doc:name="Set the HTTP Status - 401" doc:id="132ee112-f987-4e31-888c-fa72cccec767" variableName="httpStatus" />
      			<set-variable value="UNAUTHORIZED" doc:name="Set Error Code" doc:id="064e1f3b-f476-4843-bd4f-1601bccaa41f" variableName="errorCode" />
			<set-variable value='#[if (error.muleMessage.payload != null) error.muleMessage.payload else error.description default ""]' doc:name="Set Error Message" doc:id="50333af3-b8fa-4a9e-b37b-a6f32e46c569" variableName="errorMessage" />
			<flow-ref doc:name="global-prepare-error-response-sub-flow" doc:id="1416fa68-7750-41f7-8ed3-ad51d93b4dad" name="global-prepare-error-response-sub-flow"/>
		</on-error-continue>
		<on-error-continue type="HTTP:UNSUPPORTED_MEDIA_TYPE" enableNotifications="true" logException="true" doc:name="On Error Continue" doc:id="2390376f-f162-4428-a139-25254a261713" >
			<set-variable value="#[415]" doc:name="Set the HTTP Status - 415" doc:id="231ad1ed-99ee-4f75-83da-02bccd9fcc7f" variableName="httpStatus" />
      			<set-variable value="UNSUPPORTED_MEDIA_TYPE" doc:name="Set Error Code" doc:id="23723fcb-5287-452b-add5-21af631a77a8" variableName="errorCode" />
			<set-variable value='#[if (error.muleMessage.payload != null) error.muleMessage.payload else error.description default ""]' doc:name="Set Error Message" doc:id="6dd955ac-9b1b-4701-b2d0-cb889bc187d7" variableName="errorMessage" />
			<flow-ref doc:name="global-prepare-error-response-sub-flow" doc:id="1f941f27-f376-44b4-8ae1-60f438317563" name="global-prepare-error-response-sub-flow"/>
		</on-error-continue>
		
		<!-- Streaming related exception -->
		<on-error-continue type="STREAM_MAXIMUM_SIZE_EXCEEDED" enableNotifications="true" logException="true" doc:name="On Error Continue" doc:id="149e285c-9b0f-45b1-9aad-89f8533838ed" >
			<set-variable value="#[500]" doc:name="Set the HTTP Status - 500" doc:id="fd225042-9bcb-4ef9-9bae-392a270b0d96" variableName="httpStatus" />
      			<set-variable value="INTERNAL_SERVER_ERROR" doc:name="Set Error Code" doc:id="f80d49c5-f1cd-4c6c-9ac0-e5136b52faf5" variableName="errorCode" />
			<set-variable value='#[if (error.muleMessage.payload != null) error.muleMessage.payload else error.description default ""]' doc:name="Set Error Message" doc:id="d5ca2963-d8b2-4566-8537-21bde058a24a" variableName="errorMessage" />
			<flow-ref doc:name="global-prepare-error-response-sub-flow" doc:id="51bef665-c7fd-4fd1-a1c9-fddd4b7fa703" name="global-prepare-error-response-sub-flow"/>
		</on-error-continue>
		
		<!-- Generic CONNECTIVITY Related Exception handling start. Order matters -->
		<on-error-continue type="RETRY_EXHAUSTED" enableNotifications="true" logException="true" doc:name="On Error Continue" doc:id="03bcb3c4-ea84-425b-b11c-55b86c8e3626" >
			<set-variable value="#[503]" doc:name="Set the HTTP Status - 503" doc:id="1d84a2bd-9e23-4af9-b79a-84ebd3be0d53" variableName="httpStatus" />
      			<set-variable value="SERVICE_UNAVAILABLE" doc:name="Set Error Code" doc:id="5478ae8a-73f2-4c0b-871c-6f3b4c6f67ec" variableName="errorCode" />
			<set-variable value='#[if (error.muleMessage.payload != null) error.muleMessage.payload else error.description default ""]' doc:name="Set Error Message" doc:id="c46057d9-f3b8-4130-bf3d-394f010ddc8d" variableName="errorMessage" />
			<flow-ref doc:name="global-prepare-error-response-sub-flow" doc:id="de8d093b-8164-491d-8dcb-dfc70caf660f" name="global-prepare-error-response-sub-flow"/>
		</on-error-continue>
		<on-error-continue type="REDELIVERY_EXHAUSTED" enableNotifications="true" logException="true" doc:name="On Error Continue" doc:id="3f54215d-6255-4488-80c3-9c14d6f41872" >
			<set-variable value="#[503]" doc:name="Set the HTTP Status - 503" doc:id="58a14059-88cf-49ba-ab15-9fee26a8986a" variableName="httpStatus" />
      			<set-variable value="SERVICE_UNAVAILABLE" doc:name="Set Error Code" doc:id="4f762f30-f189-43eb-b3e2-a048e5aaf928" variableName="errorCode" />
			<set-variable value='#[if (error.muleMessage.payload != null) error.muleMessage.payload else error.description default ""]' doc:name="Set Error Message" doc:id="c4b5c97c-152f-4043-9208-82cc7fd1cc65" variableName="errorMessage" />
			<flow-ref doc:name="global-prepare-error-response-sub-flow" doc:id="e370fd86-43d2-45e2-a82f-36626599fec6" name="global-prepare-error-response-sub-flow"/>
		</on-error-continue>
		<on-error-continue type="CONNECTIVITY" enableNotifications="true" logException="true" doc:name="On Error Continue" doc:id="19084919-df48-4ebd-bb80-57e645b471df" >
			<set-variable value="#[503]" doc:name="Set the HTTP Status - 503" doc:id="8aa3d1b4-8d38-4f06-a625-b3bb71481046" variableName="httpStatus" />
      			<set-variable value="SERVICE_UNAVAILABLE" doc:name="Set Error Code" doc:id="0d1b71a9-7f04-4422-a63a-adbc9cbe5829" variableName="errorCode" />
			<set-variable value='#[if (error.muleMessage.payload != null) error.muleMessage.payload else error.description default ""]' doc:name="Set Error Message" doc:id="58aab055-19b1-426e-bf21-2fb5b5c1d4e3" variableName="errorMessage" />
			<flow-ref doc:name="global-prepare-error-response-sub-flow" doc:id="436d2d46-cc76-420b-aeb3-aaa85b842b82" name="global-prepare-error-response-sub-flow"/>
		</on-error-continue>
		<on-error-continue type="TIMEOUT" enableNotifications="true" logException="true" doc:name="On Error Continue" doc:id="0ec5b368-c14f-4340-af96-94b762dcdc29" >
			<set-variable value="#[504]" doc:name="Set the HTTP Status - 504" doc:id="b0843eab-f125-42e6-b116-a956d7497be0" variableName="httpStatus" />
      			<set-variable value="GATEWAY_TIMEOUT" doc:name="Set Error Code" doc:id="02c1e40b-d090-42f4-8e80-164de4828d36" variableName="errorCode" />
			<set-variable value='#[if (error.muleMessage.payload != null) error.muleMessage.payload else error.description default ""]' doc:name="Set Error Message" doc:id="45f2d9e6-0296-4a68-928b-b079a32607e4" variableName="errorMessage" />
			<flow-ref doc:name="global-prepare-error-response-sub-flow" doc:id="ff8a1781-9215-4477-8ae6-1cf6d2214a21" name="global-prepare-error-response-sub-flow"/>
		</on-error-continue>
		<!-- Generic CONNECTIVITY Exception handling end -->
		
		<on-error-continue type="TRANSFORMATION" enableNotifications="true" logException="true" doc:name="On Error Continue" doc:id="dfb3631a-9197-4cf7-8835-16383b97d3b2" >
			<set-variable value="#[400]" doc:name="Set the HTTP Status - 400" doc:id="05c5b198-dc1f-46eb-97c5-1d3d269c1c49" variableName="httpStatus" />
      			<set-variable value="BAD_REQUEST" doc:name="Set Error Code" doc:id="db061837-4a68-4915-958f-09956d4fc77c" variableName="errorCode" />
			<set-variable value='#[if (error.muleMessage.payload != null) error.muleMessage.payload else error.description default ""]' doc:name="Set Error Message" doc:id="d997d3dd-3c8a-4e22-95c7-372ba9eda1b8" variableName="errorMessage" />
			<flow-ref doc:name="global-prepare-error-response-sub-flow" doc:id="0b0cd6aa-29e4-4a52-9114-bb0c40a83893" name="global-prepare-error-response-sub-flow"/>
		</on-error-continue>
		
		<on-error-continue type="EXPRESSION" enableNotifications="true" logException="true" doc:name="On Error Continue" doc:id="eef447de-d223-4c6c-a779-8f2347bbc33d" >
			<set-variable value="#[500]" doc:name="Set the HTTP Status - 500" doc:id="6f9c46e1-18a3-4563-a00d-6bb7f1cf1989" variableName="httpStatus" />
			<set-variable value="INTERNAL_SERVER_ERROR" doc:name="Set Error Code" doc:id="d3d3f469-67c5-4bf7-be55-7f688bd1a4c3" variableName="errorCode" />
			<set-variable value='#[if (error.muleMessage.payload != null) error.muleMessage.payload else error.description default ""]' doc:name="Set Error Message" doc:id="e072e896-ff05-47f2-bbc9-8686151b37b6" variableName="errorMessage" />
			<flow-ref doc:name="global-prepare-error-response-sub-flow" doc:id="96cd32c7-2310-4425-b228-4b779b1f6257" name="global-prepare-error-response-sub-flow"/>
		</on-error-continue>	
		<on-error-continue type="ROUTING" enableNotifications="true" logException="true" doc:name="On Error Continue" doc:id="de53291b-2e5d-4a43-bd7e-cd5020d30d34" >
			<set-variable value="#[400]" doc:name="Set the HTTP Status - 400" doc:id="e5e2d963-a857-4da1-95a6-f27a2a1ea43b" variableName="httpStatus" />
      			<set-variable value="BAD_REQUEST" doc:name="Set Error Code" doc:id="b48348c7-cd36-4a54-b7f4-da1d2aa9728e" variableName="errorCode" />
			<set-variable value='#[if (error.muleMessage.payload != null) error.muleMessage.payload else error.description default ""]' doc:name="Set Error Message" doc:id="ff453b4f-aec8-446c-aa1c-53c64e63d746" variableName="errorMessage" />
			<flow-ref doc:name="global-prepare-error-response-sub-flow" doc:id="0d8e6029-f1fb-4d94-855b-f86af171d29b" name="global-prepare-error-response-sub-flow"/>
		</on-error-continue>
		<on-error-continue type="SECURITY" enableNotifications="true" logException="true" doc:name="On Error Continue" doc:id="51ce57a9-7394-4551-a710-6e8e26097162" >
			<set-variable value="#[401]" doc:name="Set the HTTP Status - 401" doc:id="a72e0b54-d42a-4736-9ffe-87912ab22213" variableName="httpStatus" />
      			<set-variable value="UNAUTHORIZED" doc:name="Set Error Code" doc:id="24eb7f54-675e-4ac9-8c24-b61ee0c381a6" variableName="errorCode" />
			<set-variable value='#[if (error.muleMessage.payload != null) error.muleMessage.payload else error.description default ""]' doc:name="Set Error Message" doc:id="1b088302-40a1-40b1-9597-c4ba306be5bf" variableName="errorMessage" />
			<flow-ref doc:name="global-prepare-error-response-sub-flow" doc:id="41ee9c6c-6973-4bbd-a7f6-f9e298dc4b9b" name="global-prepare-error-response-sub-flow"/>
		</on-error-continue>
		
		
		<!-- If none of the above matches then handle a the exception using generic handler -->
		<on-error-continue type="ANY" enableNotifications="true" logException="true" doc:name="On Error Continue" doc:id="e650df0d-0567-49a4-b233-4ce321ae0b58">
			<set-variable value="#[500]" doc:name="Set HTTP Status - 500" variableName="httpStatus" />
			<set-variable value="INTERNAL_SERVER_ERROR" doc:name="Set Error Code" doc:id="914c581b-1105-4156-a0a9-6a0cfcef529c" variableName="errorCode" />
			<set-variable value='#[if (error.muleMessage.payload != null) error.muleMessage.payload else error.description default ""]' doc:name="Set Error Message" doc:id="5ec9fe3f-5394-41c6-9664-457c398fa5fa" variableName="errorMessage" />
			<flow-ref doc:name="global-prepare-error-response-sub-flow" doc:id="17752d9f-cf4f-4a6e-a729-f574cf30584a" name="global-prepare-error-response-sub-flow" />
		</on-error-continue>
		
	
</error-handler>
    
    <sub-flow name="global-prepare-error-response-sub-flow" doc:id="969a173c-aefe-4d6e-972c-428acabf9db1">
		<logger level="ERROR" doc:name="Logger" doc:id="6e5e60fd-2479-4c49-bced-62e873070dcc" message="Status Code [#[vars.httpStatus]] - Error Code [#[vars.errorCode]] - Error Message [#[if(vars.errorMessage != null) vars.errorMessage else '']] - Error Description [#[if(vars.errorDescription != null) vars.errorDescription else '']]" />
		<ee:transform doc:name="Compose Error Payload" doc:id="4709390d-0e47-4de9-ac0d-33fbed5ac1fc">
			<ee:message>
				<ee:set-payload><![CDATA[%dw 2.0
output application/json
---
error: {
	error_code: vars.errorCode,
	error_datetime: now() as String { format: "yyyy-MM-dd'T'HH:mm:ssZ" },
	(error_message: vars.errorMessage) if(vars.errorMessage != null),
	(error_description: vars.errorDescription) if(vars.errorDescription != null)
}]]></ee:set-payload>
			</ee:message>
		</ee:transform>
		<set-variable value="#[(vars.outboundHeaders default {}) ++ {'x-correlation-id': correlationId}]" doc:name="Add correlationId to outboundHeaders" doc:id="4a5876c4-4962-44c8-84d2-184c9a3656d9" variableName="outboundHeaders" mimeType="application/java" />
    </sub-flow>
	
	</mule>
